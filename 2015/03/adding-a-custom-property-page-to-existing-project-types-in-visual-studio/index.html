<!doctype html>




<html class="theme-next pisces" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">






<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="google-site-verification" content="lYE6Wy4AMVpA-paUiNWFLIZFk8vqATN4AedYdumNuVo">













  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=IBM Plex Sans:300,300italic,400,400italic,700,700italic|Roboto Condensed:300,300italic,400,400italic,700,700italic|Gloria Hallelujah:300,300italic,400,400italic,700,700italic|Fira Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css">






  <link rel="alternate" href="/atom.xml" title="In Absentia" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1">






<meta name="description" content="Note: this post assumes some knowledge developing Visual Studio Extensions (VSIX). Suppose you’re developing custom tooling that enhances (or otherwise modifies) current project types (for example, C#">
<meta property="og:type" content="article">
<meta property="og:title" content="Adding a custom property page to existing project types in Visual Studio">
<meta property="og:url" content="http://hmemcpy.com/2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/index.html">
<meta property="og:site_name" content="In Absentia">
<meta property="og:description" content="Note: this post assumes some knowledge developing Visual Studio Extensions (VSIX). Suppose you’re developing custom tooling that enhances (or otherwise modifies) current project types (for example, C#">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://hmemcpy.com/2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/prop.png">
<meta property="og:updated_time" content="2019-02-27T05:10:03.544Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Adding a custom property page to existing project types in Visual Studio">
<meta name="twitter:description" content="Note: this post assumes some knowledge developing Visual Studio Extensions (VSIX). Suppose you’re developing custom tooling that enhances (or otherwise modifies) current project types (for example, C#">
<meta name="twitter:image" content="http://hmemcpy.com/2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/prop.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: false,
    duoshuo: {
      userId: 'undefined',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://hmemcpy.com/2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/">





  <title>Adding a custom property page to existing project types in Visual Studio | In Absentia</title>
</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="en">

  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-70273-3', 'auto');
  ga('send', 'pageview');
</script>












  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">In Absentia</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">by Igal Tabachnik</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-rss">
          <a href="/atom.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-rss"></i> <br>
            
            Subscribe
          </a>
        </li>
      

      
    </ul>
  

  
</nav>


 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope="" itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://hmemcpy.com/2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Igal Tabachnik">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars2.githubusercontent.com/u/601206?v=3&s=460">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="In Absentia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Adding a custom property page to existing project types in Visual Studio</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-03-27T19:53:18+00:00">
                2015-03-27
              </time>
            

            

            
            
              <span class="post-edit">
                <span class="post-meta-divider">|</span>
                <i class="fa fa-pencil" aria-hidden="true"></i>
                <a href="https://github.com/hmemcpy/hmemcpy.com/edit/master/source/_posts/2015-03-27-adding-a-custom-property-page-to-existing-project-types-in-visual-studio.md">Edit this page</a>
              </span>
            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><em>Note: this post assumes some knowledge developing Visual Studio Extensions (VSIX).</em></p>
<p>Suppose you’re developing custom tooling that enhances (or otherwise modifies) current project types (for example, C# class libraries or Web applications). This is most commonly done by specifying custom MSBuild properties, typically by adding a <code>.targets</code> file to the project file itself (possibly via NuGet, which can <a href="http://docs.nuget.org/Release-Notes/NuGet-2.5#automatic-import-of-msbuild-targets-and-props-files" target="_blank" rel="noopener">import <code>.targets</code> files automatically</a>).</p>
<p>One common way to interact with those custom properties is by adding a page in the project properties, however, most documentation about extending project properties refers to creating your own project systems. Any documentation about extending existing projects is either out of date, or nonexistent.</p>
<a id="more"></a>
<p>But, when there’s a will &ndash; there’s a way. TL;DR: Here’s how to add a custom property page to a regular C# console application:</p>
<ol>
<li>Create an (empty) VSIX project </li>
<li>Add a reference to the following assemblies: <code>Microsoft.VisualStudio.AppDesigner.dll</code> (located in the GAC), and <code>Microsoft.VisualStudio.ManagedInterfaces.dll</code> (from the Visual Studio SDK) </li>
<li>Create a new class that derives from <code>Microsoft.VisualStudio.Editors.PropertyPages.PropPageBase</code> </li>
<li>Implement the class as follows:</li>
</ol>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">[<span class="meta">ComVisible(true)</span>]</span><br><span class="line">[<span class="meta">Guid(<span class="meta-string">"some-guid"</span>)</span>]</span><br><span class="line">[<span class="meta">ProvideObject(typeof(MyPropertyPageProvider))</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyPropertyPageProvider</span> : <span class="title">PropPageBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">override</span> Type ControlType</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> <span class="keyword">typeof</span>(MyPropertyPageControl); &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">string</span> Title</span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> <span class="string">"My Property Page"</span>; &#125; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> Control <span class="title">CreateControl</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MyPropertyPageControl();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Make sure to provide a new GUID in the <code>GuidAttribute</code> (tip: if you use ReSharper, you can create new GUIDs on the fly by typing <code>nguid</code> and pressing Tab), we will need this GUID again soon. Specify the title of your property page, and provide an instance of a UserControl-derived (WinForms, baby!) page that will be the UI. Visual Studio provides an abstract <code>Microsoft.VisualStudio.Editors.PropertyPages.PropPageUserControlBase</code> class you can derive from.</p>
<p><strong>Important:</strong> Visual Studio will try reading the size of the control from the assembly’s compiled resources &ndash; this requires a .resx file for the user control. Best to create a new User Control using the Add &ndash; User Control context menu (so it can have a .Designer and a .resx files), and change the base type to <code>PropPageUserControlBase</code> afterwards.</p>
<p>One last piece of the puzzle is hooking it up &ndash; this is where a bit of MSBuild magic comes in. After running your extension (in the Experimental Instance), create a new, say, C# Console application. When the project is created, open its .csproj file in Notepad (or your favorite editor), and add the following property into one of the <code>PropertyGroup</code>s (or create your own <code>PropertyGroup</code>, e.g.):</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;PropertyGroup&gt;</span><br><span class="line">  &lt;CfgPropertyPagesGuidsAddCSharp&gt;&#123;some-guid&#125;&lt;/CfgPropertyPagesGuidsAddCSharp&gt;</span><br><span class="line">&lt;/PropertyGroup&gt;</span><br></pre></td></tr></table></figure>
<p>Using the GUID from before. Save the .csproj file, and when you reload it in Visual Studio, you will now have a brand new (albeit empty) property page in the project’s properties!</p>
<img src="/2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/prop.png" title="Hello Property Page!">
<p>(You can probably add this property dynamically with DTE from your extension, instead of modifying existing projects, but I haven’t tried it.)</p>
<p>So what happened? Where did <code>CfgPropertyPagesGuidsAddCSharp</code> come from, and what makes it so special? Turns out, after a long investigation, it’s an <em>undocumented</em> property, which is a part of the legacy C# and VB project systems. When Visual Studio processes C# or VB projects, it will look for this property, and attempt to instantiate the COM class at a given GUID. If successful, it will add it as a property page.</p>
<p>I was able to confirm this works in Visual Studio 2013 and 2015, not sure about the earlier editions.</p>
<p>So there you have it, a bit of undocumented functionality makes the impossible possible :)</p>
<p>Happy hacking!</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/03/disabling-certain-invisibles-in-the-atom-editor/" rel="next" title="Disabling certain " invisibles"="" in="" the="" atom="" editor"="">
                <i class="fa fa-chevron-left"></i> Disabling certain "invisibles" in the Atom Editor
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/04/preventing-a-certain-windows-update-from-installing-on-windows-10/" rel="prev" title="Preventing a certain Windows Update from installing on Windows 10">
                Preventing a certain Windows Update from installing on Windows 10 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="https://avatars2.githubusercontent.com/u/601206?v=3&s=460" alt="Igal Tabachnik">
          <p class="site-author-name" itemprop="name">Igal Tabachnik</p>
           
        </div>
        <nav class="site-state motion-element">

          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/hmemcpy" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/hmemcpy" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://stackoverflow.com/users/story/8205" target="_blank" title="StackOverflow">
                  
                    <i class="fa fa-fw fa-stack-overflow"></i>
                  
                  StackOverflow
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://il.linkedin.com/in/igaltabachnik" target="_blank" title="LinkedIn">
                  
                    <i class="fa fa-fw fa-linkedin"></i>
                  
                  LinkedIn
                </a>
              </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons">
            </a>
          </div>
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy;  2009 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Igal Tabachnik</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://hmemcpy.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://hmemcpy.com/2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/';
          this.page.identifier = '2015/03/adding-a-custom-property-page-to-existing-project-types-in-visual-studio/';
          this.page.title = 'Adding a custom property page to existing project types in Visual Studio';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://hmemcpy.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  













  





  

  

  

  

  

</body>
</html>
